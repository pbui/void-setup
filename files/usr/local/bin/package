#!/bin/sh

usage () {
	cat << EOF
Usage: $PROGNAME COMMAND [TARGET]

Commands:
  update		Update package repositories
  upgrade		Upgrade all packages
  install   PACKAGES	Install packages
  remove    PACKAGES	Remove packages
  search    PACKAGES	Search packages
  show	    PACKAGES	Show package information
  manifest  PACKAGES	Display package manifest
EOF
	exit 1
}

if [ $# = 0 ]; then
    usage
fi

ACTION=$1
PROGNAME=$(basename $0)
shift
PACKAGES="$@"

case $ACTION in
update)
	sudo xbps-install -S
	;;
upgrade)
	sudo xbps-install -Su
	;;
add|install)
	[ $# -eq 0 ] && usage

	if stat ${PACKAGES} > /dev/null 2>&1; then
		sudo xdowngrade $PACKAGES
	else
		sudo xbps-install -S $PACKAGES
	fi
	;;
del|remove|rm)
	[ $# -eq 0 ] && usage
	sudo xbps-remove -R $PACKAGES
	;;
search)
	[ $# -eq 0 ] && usage
	sudo xbps-query -Rs $PACKAGES
	;;
show)
	[ $# -eq 0 ] && usage
	sudo xbps-query -S $PACKAGES
	;;
list|manifest)
	[ $# -eq 0 ] && usage
	sudo xbps-query -f $PACKAGES
	;;
*)
	usage
	;;
esac
